# make the environment
 apt-get update && apt-get install -y --no-install-recommends \
    build-essential \
    cmake \
    git \
    libmlpack-dev \
    python-numpy \
    python-setuptools \
    python-pip \
    libboost-all-dev \
    wget && \
    rm -rf /var/lib/apt/lists/*

    echo 'Installing blosc'
    export PREFIX=$HOME
    export NUM_MAKE_CORES=10
    export BLOSC_ROOT=${PREFIX}/src/c-blosc
    export BLOSC_REVISION=1.15.1
    export BLOSC_REPO=https://github.com/Blosc/c-blosc
    export BLOSC_REV=1.15.1
    mkdir -p $BLOSC_ROOT
    cd $BLOSC_ROOT
    git clone ${BLOSC_REPO} . && git checkout ${BLOSC_REV}
    cmake -DWITH_BLOSC=OFF -DWITH_ZLIB=ON -DWITH_BZIP2=ON -DWITH_XZ=ON -DCMAKE_CXX_FLAGS="-std=c++17" && \
    make -j $NUM_MAKE_CORES && \
    make install
    
    export PYTHONPATH=${BLOSC_ROOT}:$PYTHONPATH

    export BOOST_VERSION=1.69.0
    export BOOST_VERSION_UNDERSCORE=1_69_0
    export BOOST_ROOT=${PREFIX}/src/boost_${BOOST_VERSION_UNDERSCORE}
    export BOOST_TAR=$HOME/boost_${BOOST_VERSION_UNDERSCORE}.tar.gz
    export BOOST_SRC=https://dl.bintray.com/boostorg/release/${BOOST_VERSION}/source/boost_${BOOST_VERSION_UNDERSCORE}.tar.gz

    mkdir -p ${BOOST_ROOT}
    cd ${BOOST_ROOT}
    wget ${BOOST_SRC} -O ${BOOST_TAR}
    tar xf ${BOOST_TAR} -C $PREFIX/src
    ./bootstrap.sh
    ./b2 --with-filesystem --with-system install
    # RUN ./bjam install

    pip install pytest


    export PYBIND11_ROOT=${PREFIX}/src/pybind11
    export PYBIND11_REPOSITORY=https://github.com/pybind/pybind11
    export PYBIND11_REVISION=v2.2.4
